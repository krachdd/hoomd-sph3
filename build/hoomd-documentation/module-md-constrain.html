<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="md.compute" href="module-md-compute.html" /><link rel="prev" title="md.bond" href="module-md-bond.html" />

    <link rel="shortcut icon" href="_static/hoomdblue-logo-favicon.svg"/><!-- Generated with Sphinx 5.0.2 and Furo 2023.03.27 -->
        <title>md.constrain - HOOMD-blue 3.10.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  --color-brand-primary: #406a8c;
  --color-brand-content: #406a8c;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #5187b2;
  --color-brand-content: #5187b2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #5187b2;
  --color-brand-content: #5187b2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">HOOMD-blue 3.10.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/hoomdblue-logo-vertical.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing binaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrating.html">Migrating to HOOMD v3</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing HOOMD-blue</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/00-index.html">Introducing HOOMD-blue</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/01-The-Simulation-Object.html">The Simulation Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/02-Performing-Hard-Particle-Monte-Carlo-Simulations.html">Performing Hard Particle Monte Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/03-Initializing-the-System-State.html">Initializing the System State</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/04-Randomizing-the-System.html">Randomizing the System</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/05-Compressing-the-System.html">Compressing the System</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/06-Equilibrating-the-System.html">Equilibrating the System</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/00-Introducing-HOOMD-blue/07-Analyzing-Trajectories.html">Analyzing Trajectories</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/01-Introducing-Molecular-Dynamics/00-index.html">Introducing Molecular Dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/01-Introducing-Molecular-Dynamics/01-Molecular-Dynamics-Simulations.html">Molecular Dynamics Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/01-Introducing-Molecular-Dynamics/02-Initializing-a-Random-System.html">Initializing a Random System</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/01-Introducing-Molecular-Dynamics/03-Compressing-the-System.html">Compressing the System</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/02-Logging/00-index.html">Logging</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/02-Logging/01-Logging-to-a-GSD-file.html">Logging to a GSD file</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/02-Logging/02-Saving-Array-Quantities.html">Saving Array Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/02-Logging/03-Storing-Particle-Shape.html">Storing Particle Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/02-Logging/04-Writing-Formatted-Output.html">Writing Formatted Output</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/03-Parallel-Simulations-With-MPI/00-index.html">Parallel Simulation With MPI</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/03-Parallel-Simulations-With-MPI/01-Introduction-to-MPI.html">Introduction to MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/03-Parallel-Simulations-With-MPI/02-Domain-Decomposition.html">Domain Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/03-Parallel-Simulations-With-MPI/03-Accessing-System-Configurations-With-MPI.html">Accessing System Configurations With MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/03-Parallel-Simulations-With-MPI/04-Running-Multiple-Simulations-With-Partitions.html">Running Multiple Simulations With Partitions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/00-index.html">Custom Actions in Python</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/01-What-are-Actions.html">What are Actions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/02-An-Initial-Custom-Action.html">An Initial Custom Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/03-Custom-Action-Features.html">Custom Action Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/04-Custom-Updater.html">Custom Updater</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/05-Custom-Writer.html">Custom Writer</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/04-Custom-Actions-In-Python/06-Improving-Performance.html">Improving Performance</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/05-Organizing-and-Executing-Simulations/00-index.html">Organizing and Executing Simulations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/05-Organizing-and-Executing-Simulations/01-Organizing-Data.html">Organizing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/05-Organizing-and-Executing-Simulations/02-Executing-Simulations.html">Executing Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/05-Organizing-and-Executing-Simulations/03-Continuing-Simulations.html">Continuing Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/05-Organizing-and-Executing-Simulations/04-Submitting-Cluster-Jobs.html">Submitting Cluster Jobs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial/06-Modelling-Rigid-Bodies/00-index.html">Modelling Rigid Bodies</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/06-Modelling-Rigid-Bodies/01-Introduction-to-Rigid-Bodies.html">Introduction to Rigid Bodies</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/06-Modelling-Rigid-Bodies/02-Running-Rigid-Body-Simulations.html">Running Rigid Body Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/06-Modelling-Rigid-Bodies/03-Preparing-a-General-Body.html">Preparing a General Body</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="howto/molecular.html">How to model molecular systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/cpppotential.html">How to apply arbitrary pair potentials in HPMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="package-hoomd.html">hoomd</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-box.html">hoomd.box</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-communicator.html">hoomd.communicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-custom.html">hoomd.custom</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-hoomd-data.html">hoomd.data</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-hoomd-array.html">hoomd.data.array</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-device.html">hoomd.device</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-error.html">hoomd.error</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-filter.html">hoomd.filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-logging.html">hoomd.logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-mesh.html">hoomd.mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-operation.html">hoomd.operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-triggers.html">hoomd.trigger</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-tune.html">hoomd.tune</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-update.html">hoomd.update</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-variant.html">hoomd.variant</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-version.html">hoomd.version</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-wall.html">hoomd.wall</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hoomd-write.html">hoomd.write</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="package-hpmc.html">hoomd.hpmc</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="module-hpmc-compute.html">hoomd.hpmc.compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hpmc-integrate.html">hoomd.hpmc.integrate</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-hpmc-nec.html">hoomd.hpmc.nec</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-hpmc-nec-integrate.html">hoomd.hpmc.nec.integrate</a></li>
<li class="toctree-l3"><a class="reference internal" href="module-hpmc-nec-tune.html">hoomd.hpmc.nec.tune</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-hpmc-tune.html">hoomd.hpmc.tune</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-hpmc-update.html">hoomd.hpmc.update</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-hpmc-pair.html">hoomd.hpmc.pair</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-hpmc-pair-user.html">hoomd.hpmc.pair.user</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-hpmc-external.html">hoomd.hpmc.external</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-hpmc-external-user.html">hoomd.hpmc.external.user</a></li>
<li class="toctree-l3"><a class="reference internal" href="module-hpmc-external-field.html">hoomd.hpmc.external.field</a></li>
<li class="toctree-l3"><a class="reference internal" href="module-hpmc-external-wall.html">hoomd.hpmc.external.wall</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-hpmc-shape_move.html">hoomd.hpmc.shape_move</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="package-md.html">hoomd.md</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="module-md-alchemy.html">md.alchemy</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-md-alchemy-pair.html">md.alchemy.pair</a></li>
<li class="toctree-l3"><a class="reference internal" href="module-md-alchemy-methods.html">md.alchemy.methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-md-angle.html">md.angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-bond.html">md.bond</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">md.constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-compute.html">md.compute</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-data.html">md.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-dihedral.html">md.dihedral</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-md-external.html">md.external</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-md-external-field.html">md.external.field</a></li>
<li class="toctree-l3"><a class="reference internal" href="module-md-external-wall.html">md.external.wall</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-md-force.html">md.force</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-improper.html">md.improper</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-md-long_range.html">md.long_range</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-md-long_range-pppm.html">md.long_range.pppm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-md-manifold.html">md.manifold</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-many_body.html">md.many_body</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-md-methods.html">md.methods</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-md-methods-rattle.html">md.methods.rattle</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-md-mesh.html">md.mesh</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-md-mesh-bond.html">md.mesh.bond</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-md-minimize.html">md.minimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-nlist.html">md.nlist</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="module-md-pair.html">md.pair</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="module-md-pair-aniso.html">md.pair.aniso</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module-md-special_pair.html">md.special_pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-tune.html">md.tune</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-md-update.html">md.update</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="style.html">Code style</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notation.html">Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="deprecated.html">Deprecated</a></li>
<li class="toctree-l1"><a class="reference internal" href="logo.html">Logo</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="indices.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="md-constrain">
<h1>md.constrain<a class="headerlink" href="#md-constrain" title="Permalink to this heading">#</a></h1>
<p class="rubric">Overview</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.md.constrain.Constraint" title="hoomd.md.constrain.Constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Constraint</span></code></a></p></td>
<td><p>Constraint force base class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hoomd.md.constrain.Distance" title="hoomd.md.constrain.Distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Distance</span></code></a></p></td>
<td><p>Constrain pairwise particle distances.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Rigid</span></code></a></p></td>
<td><p>Constrain particles in rigid bodies.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Details</p>
<span class="target" id="module-hoomd.md.constrain"></span><p>Constraints.</p>
<p>Constraint force classes apply forces and the resulting virial to particles that
enforce specific constraints on the positions of the particles. The constraint
is satisfied at all times, so there is no potential energy associated with the
constraint.</p>
<p>Each constraint removes a number of degrees of freedom from the system.
<a class="reference internal" href="module-md-compute.html#hoomd.md.compute.ThermodynamicQuantities" title="hoomd.md.compute.ThermodynamicQuantities"><code class="xref any py py-class docutils literal notranslate"><span class="pre">hoomd.md.compute.ThermodynamicQuantities</span></code></a> accounts for these lost degrees of
freedom when computing kinetic temperature and pressure. See
<a class="reference internal" href="package-hoomd.html#hoomd.State.update_group_dof" title="hoomd.State.update_group_dof"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">hoomd.State.update_group_dof</span></code></a> for details on when the degrees of freedom for a
group are calculated.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not apply multiple constraint class instances to the same particle. Each
instance solves for its constraints independently.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="hoomd.md.constrain.Constraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hoomd.md.constrain.</span></span><span class="sig-name descname"><span class="pre">Constraint</span></span><a class="headerlink" href="#hoomd.md.constrain.Constraint" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="module-md-force.html#hoomd.md.force.Force" title="hoomd.md.force.Force"><code class="xref py py-class docutils literal notranslate"><span class="pre">Force</span></code></a></p>
<p>Constraint force base class.</p>
<p><a class="reference internal" href="#hoomd.md.constrain.Constraint" title="hoomd.md.constrain.Constraint"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a> is the base class for all constraint forces.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class should not be instantiated by users. The class can be used
for <a class="reference external" href="https://docs.python.org/3/library/functions.html#isinstance" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">isinstance</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#issubclass" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">issubclass</span></code></a> checks.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hoomd.md.constrain.Distance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hoomd.md.constrain.</span></span><span class="sig-name descname"><span class="pre">Distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hoomd.md.constrain.Distance" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hoomd.md.constrain.Constraint" title="hoomd.md.constrain.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>Constrain pairwise particle distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Relative tolerance for constraint violation warnings.</p>
</dd>
</dl>
<p><a class="reference internal" href="#hoomd.md.constrain.Distance" title="hoomd.md.constrain.Distance"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Distance</span></code></a> applies forces between particles that constrain the distances
between particles to specific values. The algorithm implemented is described
in:</p>
<ol class="arabic simple">
<li><p>M. Yoneya, H. J. C. Berendsen, and K. Hirasawa, “A Non-Iterative
Matrix Method for Constraint Molecular Dynamics Simulations,” Molecular
Simulation, vol. 13, no. 6, pp. 395–405, 1994.</p></li>
<li><p>M. Yoneya, “A Generalized Non-iterative Matrix Method for Constraint
Molecular Dynamics Simulations,” Journal of Computational Physics,
vol. 172, no. 1, pp. 188–197, Sep. 2001.</p></li>
</ol>
<p>Each distance constraint takes the form:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\chi_{ij}(r) = \mathrm{minimum\_image}(\vec{r}_j - \vec{r}_i)^2
    - d_{ij}^2 = 0\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> are the the particle tags in the
<code class="docutils literal notranslate"><span class="pre">constraint_group</span></code> and <span class="math notranslate nohighlight">\(d_{ij}\)</span> is the constraint distance as given
by the <a class="reference external" href="hoomd.State">system state</a>.</p>
<p>The method sets the second derivative of the Lagrange multipliers with
respect to time to zero, such that both the distance constraints and their
time derivatives are conserved within the accuracy of the Velocity Verlet
scheme (<span class="math notranslate nohighlight">\(O(\delta t^2)\)</span>. It solves the corresponding linear system of
equations to determine the force. The constraints are satisfied at <span class="math notranslate nohighlight">\(t
+ 2 \delta t\)</span>, so the scheme is self-correcting and avoids drifts.</p>
<p>Add an instance of <a class="reference internal" href="#hoomd.md.constrain.Distance" title="hoomd.md.constrain.Distance"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Distance</span></code></a> to the integrator constraints list
<a class="reference internal" href="package-md.html#hoomd.md.Integrator.constraints" title="hoomd.md.Integrator.constraints"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hoomd.md.Integrator.constraints</span></code></a> to apply the force during the simulation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In MPI simulations, it is an error when molecules defined by constraints
extend over more than half the local domain size because all particles
connected through constraints will be communicated between ranks as
ghost particles.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#hoomd.md.constrain.Distance.tolerance" title="hoomd.md.constrain.Distance.tolerance"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">tolerance</span></code></a> sets the tolerance to detect constraint violations and
issue a warning message. It does not influence the computation of the
constraint force.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="hoomd.md.constrain.Distance.tolerance">
<span class="sig-name descname"><span class="pre">tolerance</span></span><a class="headerlink" href="#hoomd.md.constrain.Distance.tolerance" title="Permalink to this definition">#</a></dt>
<dd><p>Relative tolerance for constraint violation warnings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hoomd.md.constrain.Rigid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hoomd.md.constrain.</span></span><span class="sig-name descname"><span class="pre">Rigid</span></span><a class="headerlink" href="#hoomd.md.constrain.Rigid" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hoomd.md.constrain.Constraint" title="hoomd.md.constrain.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>Constrain particles in rigid bodies.</p>
<p class="rubric">Overview</p>
<p>Rigid bodies are defined by a single central particle and a number of
constituent particles. All of these are particles in the simulation state
and can interact with other particles via forces. The mass and moment of
inertia of the central particle set the full mass and moment of inertia of
the rigid body (constituent particle mass is ignored).</p>
<p>The central particle is at the center of mass of the rigid body and the
particle’s orientation quaternion defines the rotation from the body space
into the simulation box. Body space refers to a rigid body viewed in a
particular reference frame. In body space, the center of mass of the body is
at <span class="math notranslate nohighlight">\((0,0,0)\)</span> and the moment of inertia is diagonal.</p>
<p class="rubric">Constituent particles</p>
<p>Select one or more particle types in the simulation to use as the central
particles. For each rigid body particle type, ou specify the constituent
particle position and orientations in body coordinates (see <a class="reference internal" href="#hoomd.md.constrain.Rigid.body" title="hoomd.md.constrain.Rigid.body"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">body</span></code></a>). Then,
<a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> takes control of the constituent particles and sets their position
and orientation in the simulation box relative to the position and
orientation of the central particle:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\vec{r}_c &amp;= \vec{r}_b
            + \mathbf{q}_b \vec{r}_{c,\mathrm{body}} \mathbf{q}_b^* \\
\mathbf{q}_c &amp;= \mathbf{q}_b \mathbf{q}_{c,\mathrm{body}}\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\vec{r}_c\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}_c\)</span> are the position and
orientation of a constituent particle in the simulation box,
<span class="math notranslate nohighlight">\(\vec{r}_{c,\mathrm{body}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}_{c,\mathrm{body}}\)</span>
are the position and orientation of that particle in body coordinates, and
<span class="math notranslate nohighlight">\(\vec{r}_b\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}_b\)</span> are the position and orientation
of the central particle of that rigid body. <a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> also sets the
constituent particle image consistent with the image of the central particle
and the location of the constituent particle wrapped back into the
box. <a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> does not modify the constituent particle type ids, charge,
or diameter.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> <strong>overwrites</strong> the constituent particle positions and
orientations. To change the position and orientation of a body, set the
desired position and orientation of the central particle and call
<a class="reference internal" href="package-hoomd.html#hoomd.Simulation.run" title="hoomd.Simulation.run"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">run(0)</span></code></a> to trigger <a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> to update the particles.</p>
</div>
<p>In the simulation state, the <code class="docutils literal notranslate"><span class="pre">body</span></code> particle property defines the particle
tag of the central particle: <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">body[c]</span></code>. In setting the <code class="docutils literal notranslate"><span class="pre">body</span></code> array,
set central particles to their tag <span class="math notranslate nohighlight">\(b_i = t_i\)</span>, constituent particles
to their central particle’s tag <span class="math notranslate nohighlight">\(b_i = t_{center}\)</span>, and free particles
to -1: <span class="math notranslate nohighlight">\(b_i = -1\)</span>. Free particles are particles that are not part of
a rigid body.</p>
<p>The central particle of a rigid body must have a tag smaller than all of its
constituent particles. Constituent particles follow in monotonically
increasing tag order, corresponding to the order they are defined in the
argument to <a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> initialization. The central and constituent particles do
not need to be contiguous.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To create constituent particles, initialize a simulation state
containing only central particles (but both rigid body and constituent
particle types). Then call <a class="reference internal" href="#hoomd.md.constrain.Rigid.create_bodies" title="hoomd.md.constrain.Rigid.create_bodies"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">create_bodies</span></code></a> to add all the constituent
particles to the state.</p>
</div>
<p class="rubric">Net force and torque</p>
<p><a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> transfers forces, energies, and torques from constituent particles
to the central particle and adds them to those from the interaction on the
central particle itself. The integration methods use these forces and
torques to integrate the equations of motion of the central particles
(representing the whole rigid body) forward in time.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\vec{F}_b' &amp;= \vec{F}_b + \sum_c \vec{F}_c \\
\vec{U}_b' &amp;= U_b + \sum_c U_c \\
\vec{\tau}_b' &amp;= \vec{\tau}_b + \sum_c \vec{\tau}_c +
    (\mathbf{q}_b \vec{r}_{c,\mathrm{body}} \mathbf{q}_b^*)
    \times \vec{F}_c\end{split}\]</div>
</div>
<p><a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> also computes the corrected virial accounting for the effective
constraint force (see <a class="reference external" href="https://dx.doi.org/10.1016/j.commatsci.2019.109430">Glaser 2020</a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Include <code class="docutils literal notranslate"><span class="pre">'body'</span></code> in the <a class="reference internal" href="module-md-nlist.html#hoomd.md.nlist.NeighborList.exclusions" title="hoomd.md.nlist.NeighborList.exclusions"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Neighborlist</span> <span class="pre">exclusions</span></code></a> to avoid calculating
inter-body forces that will sum to 0. This is <em>required</em> in many cases
where nearby particles lead to numerical errors from extremely large
forces.</p>
</div>
<p class="rubric">Integrating bodies</p>
<p>Set the <code class="docutils literal notranslate"><span class="pre">rigid</span></code> attribute of <a class="reference internal" href="package-md.html#hoomd.md.Integrator" title="hoomd.md.Integrator"><code class="xref any py py-class docutils literal notranslate"><span class="pre">hoomd.md.Integrator</span></code></a> to an instance of
<a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> to apply rigid body constraints and apply an integration method (or
methods) to the central and non-rigid particles (leave the constituent
particles out - <a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> will set their position and orientation). Most
integration methods support the integration of rotational degrees of
freedom.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rigid_centers_and_free_filter</span> <span class="o">=</span> <span class="n">hoomd</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Rigid</span><span class="p">(</span>
    <span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;free&quot;</span><span class="p">))</span>
<span class="n">langevin</span> <span class="o">=</span> <span class="n">hoomd</span><span class="o">.</span><span class="n">md</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">Langevin</span><span class="p">(</span>
    <span class="nb">filter</span><span class="o">=</span><span class="n">rigid_centers_and_free_filter</span><span class="p">,</span> <span class="n">kT</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Thermodynamic quantities of bodies</p>
<p><a class="reference internal" href="module-md-compute.html#hoomd.md.compute.ThermodynamicQuantities" title="hoomd.md.compute.ThermodynamicQuantities"><code class="xref any py py-class docutils literal notranslate"><span class="pre">hoomd.md.compute.ThermodynamicQuantities</span></code></a> computes thermodynamic quantities
(temperature, kinetic energy, etc.) over the central and non-rigid particles
in the system, ignoring the consitutent particles. The body central
particles contribute translational and rotational energies to the total.</p>
<p class="rubric">Continuing simulations with rigid bodies.</p>
<p>To continue a simulation, write the simulation state to a file with
<a class="reference internal" href="module-hoomd-write.html#hoomd.write.GSD" title="hoomd.write.GSD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">hoomd.write.GSD</span></code></a> and initialize the new <a class="reference internal" href="package-hoomd.html#hoomd.Simulation" title="hoomd.Simulation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a>
using <a class="reference internal" href="package-hoomd.html#hoomd.Simulation.create_state_from_gsd" title="hoomd.Simulation.create_state_from_gsd"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">create_state_from_gsd</span></code></a>. GSD stores
all the particle data fields needed to reconstruct the state of the system,
including the body, angular momentum, and orientation of the body. You must
specify the same local body space environment to <a class="reference internal" href="#hoomd.md.constrain.Rigid.body" title="hoomd.md.constrain.Rigid.body"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">body</span></code></a> as you did in the
earlier simulation - GSD does not store this information.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rigid</span> <span class="o">=</span> <span class="n">constrain</span><span class="o">.</span><span class="n">Rigid</span><span class="p">()</span>
<span class="n">rigid</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;constituent_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A_const&#39;</span><span class="p">,</span> <span class="s1">&#39;A_const&#39;</span><span class="p">],</span>
    <span class="s2">&quot;positions&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
    <span class="s2">&quot;orientations&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)],</span>
    <span class="s2">&quot;charges&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="s2">&quot;diameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
    <span class="p">}</span>
<span class="n">rigid</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;constituent_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B_const&#39;</span><span class="p">,</span> <span class="s1">&#39;B_const&#39;</span><span class="p">],</span>
    <span class="s2">&quot;positions&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">.5</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">.5</span><span class="p">)],</span>
    <span class="s2">&quot;orientations&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)],</span>
    <span class="s2">&quot;charges&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="s2">&quot;diameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
    <span class="p">}</span>

<span class="c1"># Can set rigid body definition to be None explicitly.</span>
<span class="n">rigid</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> will significantly slow simulation performance when frequently
changing rigid body definitions or adding/removing particles from the
simulation.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="hoomd.md.constrain.Rigid.body">
<span class="sig-name descname"><span class="pre">body</span></span><a class="headerlink" href="#hoomd.md.constrain.Rigid.body" title="Permalink to this definition">#</a></dt>
<dd><p><a class="reference internal" href="#hoomd.md.constrain.Rigid.body" title="hoomd.md.constrain.Rigid.body"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">body</span></code></a> is a mapping from the central particle type to a body definition
represented as a dictionary. The mapping respects <code class="docutils literal notranslate"><span class="pre">None</span></code> as meaning
that the type is not a rigid body center. All types are set to <code class="docutils literal notranslate"><span class="pre">None</span></code>
by default. The keys for the body definition are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">constituent_types</span></code> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">str</span></code></a>]): List of types of constituent
particles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">positions</span></code> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">tuple</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>]]): List of
relative positions of constituent particles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orientations</span></code> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">tuple</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>]]): List of orientations (as quaternions) of constituent
particles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">charges</span></code> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>]): List of charges of constituent
particles.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version v3.7.0: </span><code class="docutils literal notranslate"><span class="pre">charges</span></code> will be removed in v4.</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">diameters</span></code> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">float</span></code></a>]): List of diameters of constituent
particles.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version v3.7.0: </span><code class="docutils literal notranslate"><span class="pre">diameters</span></code> will be removed in v4.</p>
</div>
</li>
</ul>
<p>Of these, <a class="reference internal" href="#hoomd.md.constrain.Rigid" title="hoomd.md.constrain.Rigid"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Rigid</span></code></a> uses <code class="docutils literal notranslate"><span class="pre">positions</span></code> and <code class="docutils literal notranslate"><span class="pre">orientation</span></code> to set the
constituent particle positions and orientations every time step.
<a class="reference internal" href="#hoomd.md.constrain.Rigid.create_bodies" title="hoomd.md.constrain.Rigid.create_bodies"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">create_bodies</span></code></a> uses <code class="docutils literal notranslate"><span class="pre">constituent_types</span></code>, <code class="docutils literal notranslate"><span class="pre">charges</span></code>, and
<code class="docutils literal notranslate"><span class="pre">diameters</span></code> to populate those particle properties when creating
constituent particles.</p>
<p>Type: <a class="reference internal" href="module-hoomd-data.html#hoomd.data.typeparam.TypeParameter" title="hoomd.data.typeparam.TypeParameter"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TypeParameter</span></code></a> [<code class="docutils literal notranslate"><span class="pre">particle_type</span></code>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref any docutils literal notranslate"><span class="pre">dict</span></code></a>]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hoomd.md.constrain.Rigid.create_bodies">
<span class="sig-name descname"><span class="pre">create_bodies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hoomd.md.constrain.Rigid.create_bodies" title="Permalink to this definition">#</a></dt>
<dd><p>Create rigid bodies from central particles in state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="package-hoomd.html#hoomd.State" title="hoomd.State"><em>hoomd.State</em></a>) – The state in which to create rigid bodies.</p>
</dd>
</dl>
<p><a class="reference internal" href="#hoomd.md.constrain.Rigid.create_bodies" title="hoomd.md.constrain.Rigid.create_bodies"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">create_bodies</span></code></a> removes any existing constituent particles and adds new
ones based on the body definitions in <a class="reference internal" href="#hoomd.md.constrain.Rigid.body" title="hoomd.md.constrain.Rigid.body"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">body</span></code></a>. It overwrites all existing
particle <code class="docutils literal notranslate"><span class="pre">body</span></code> tags in the state.</p>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
<div class="related-pages">
<a class="next-page" href="module-md-compute.html">
    <div class="page-info">
        <div class="context">
        <span>Next</span>
        </div>
        <div class="title">md.compute</div>
    </div>
    <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
    </a>
<a class="prev-page" href="module-md-bond.html">
    <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
    <div class="page-info">
        <div class="context">
        <span>Previous</span>
        </div>
        
        <div class="title">md.bond</div>
        
    </div>
    </a>
</div>
<div class="bottom-of-page">
<div class="left-details">
    <p>Development of HOOMD-blue is led by the <a href="https://glotzerlab.engin.umich.edu">Glotzer Group</a> at the <a href="https://umich.edu">University of Michigan</a> (supported by NSF DMR 1808342) with many <a href="credits.html">external contributions</a>.
    </p>
    <div class="copyright">
        Copyright &#169; 2009-2023 The Regents of the University of Michigan
    </div>
    Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
    
    <a href="https://github.com/pradyunsg/furo">Furo</a>
    
</div>
<div class="right-details">
    <a class="muted-link" href="http://umich.edu">
    <img src="_static/umich-block-M.svg" alt="University of Michigan logo" style="width: 84px; float: right;" />
    </a>
</div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>